#' exploitablefuelwoodvolume
#'
#' @param inventory (data.frame)
#' @param fuel no  exploitation = "0", damage exploitation in fuelwood = "1",
#' exploitation of hollow trees and damage in fuelwood = "2"
#' @param otherloggingparameters (list)
#'
#' @return A list with the damage volume, and the fuelwood volume when fuelwood exploitation is chosen.
#' @export
#'
#' @examples
#'
#' \dontrun{
#' data(Paracou6_2016)
#' inventory <- addtreedim(cleaninventory(inventorycheckformat(Paracou6_2016)))
#'
#' inventory <- treeselection(inventory, SpeciesCriteria,
#' type ="manual", fuel = "2", objective = 20, diversification = TRUE, specieslax = FALSE,
#' objectivelax = FALSE, otherloggingparameters = loggingparameters())$inventory
#'
#' inventory <- secondtrailsopening()$inventory
#'
#' inventory <- treefelling()$inventory
#'
#' inventory <- adjustedsecondtrails()$inventory
#'
#' inventory <- timberharvestedvolume()$inventory
#'
#' exploitablefuelwoodvolume(inventory, fuel = "2", otherloggingparameters = loggingparameters())
#' }
#'
exploitablefuelwoodvolume <- function(
  inventory,
  fuel,
  otherloggingparameters = loggingparameters()
){
  # Global variables
  Accessible <- Circ <- CircCorr <- CodeAlive <- Commercial <- NULL
  Commercial.genus <- Commercial.species <- Condition <- DBH <- NULL
  DeathCause <- DistCrit <- Family <- NULL
  ForestZoneVolumeParametersTable <- Genus <- Logged <- NULL
  LoggedVolume <- LoggingStatus <- MaxFD <- MaxFD.genus <- NULL
  MaxFD.species <- MinFD <- MinFD.genus <- MinFD.species <- NULL
  NoHollowLoggedVolume <- ParamCrownDiameterAllometry <- PlotSlope <- NULL
  PlotTopo <- ProbedHollow <- ProbedHollowProba <- ScientificName <- NULL
  Selected <- Slope <- SlopeCrit <- Species <- Species.genus <- NULL
  SpeciesCriteria <- Taxo <- Taxo.family <- Taxo.genus <- Taxo.species <- NULL
  TreeFellingOrientationSuccess <- TreeHarvestableVolume <- NULL
  TreeHeight <- TrunkHeight <- Up <- UpMinFD <- UpMinFD.genus <- NULL
  UpMinFD.species <- VernName.genus <- VernName.genus.genus <- NULL
  VernName.species <- VolumeCumSum <- Xutm <- Yutm <- aCoef <- NULL
  alpha <- alpha.family <- alpha.genus <- alpha.species <- bCoef <- NULL
  beta.family <- beta.genus <- beta.species <- geometry <- idTree <- NULL

  DamageTable <- inventory %>%
    filter(DeathCause == "maintrail" | DeathCause == "2ndtrail" | DeathCause == "treefall2nd" | DeathCause == "landing")

  DamageVolume <- sum(DamageTable$TreeHarvestableVolume) # only damage (without purge and hollow trees)

  if (fuel =="0"){

    outputs <- list(DamageVolume = DamageVolume, # Damage volume, non used for fuel in this scenario
                    FuelVolume = NULL
    )

  }

  if (fuel !="0"){ # fuelwood exploitation

    if (fuel =="1"){

      FuelVolume <- sum(DamageVolume + otherloggingparameters$Purge * LoggedVolume) # Damage and purge (0.14)

    }

    if (fuel =="2"){

      HollowTable <- inventory %>%
        filter(DeathCause == "hollowfuel")

      FuelVolume <- sum(DamageVolume +
                          otherloggingparameters$TreeHollowPartForFuel * (HollowTable$TreeHarvestableVolume) +
                          otherloggingparameters$Purge * NoHollowLoggedVolume)
      # damage + 1/3 of hollow trees volume + purge (0.14) of the healthy trees

    }

    outputs <- list(DamageVolume = DamageVolume, # only damage (without purge and hollow trees)
                    FuelVolume = FuelVolume
    )

  }
  return(outputs)

}
